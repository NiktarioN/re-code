(()=>{var s=new URL(window.location.href),l=e=>new URL(e,s.origin),h=(e,r)=>l(e).searchParams.has(r),U=(e,r)=>l(e).searchParams.get(r),f=(e,r)=>!!U(e,r);var p=["sb_id","sbid"],b=["page","show"],u={offerSettings:["/pl/sales/offer/update","/pl/sales/offer/create"],userDealsPage:["/sales/control/userProduct/my"],cms:{editor:["/pl/cms/page"]}},C=u.offerSettings.some(e=>s.pathname.includes(e)),D=u.userDealsPage.some(e=>s.pathname.includes(e)),q=u.cms.editor.some(e=>s.pathname.includes(e))||h(s.href,"editMode"),R=window.self!==window.top,v=b.some(e=>window?.controllerId===e);var{isAdmin:k,isTeacher:x}=window.userInfo;var w=(e,r)=>{let c=document.createElement(e);return r&&c.classList.add(r),c},g=(e,r)=>p.some(i=>r===i)?f(e,r):!0;var P=e=>e.filter(({name:r})=>r.includes("userCustomFields"));var A=e=>{let r=P(e),c=(t,a)=>{let o=document.createElement("input");return a&&o.setAttribute("data-field-title",a),o.setAttribute("name",t),o.setAttribute("type","hidden"),o},i=()=>{let t=w("div");return t.setAttribute("data-for","recode-analytic-fields"),t.setAttribute("data-author","recode studio (tg: @recode_solutions)"),t},S=(t,a)=>a.filter(({title:o,fieldSelector:d,trigger:n})=>!(t.querySelector(d)||t.querySelector(`[data-field-title="${o}"]`))&&g(s,n)),m=(t,a,o)=>{let d=S(t,o),n=i();d.forEach(({name:F,title:y})=>{n.appendChild(c(F,y)),t.querySelector(a)?t.querySelector(a).appendChild(n):t.appendChild(n)})};(()=>{document.querySelectorAll("form.lt-form").forEach(t=>{t.querySelector('[name="formParams[offer_id][]"]')||t.closest(".need-create-deal")||t.closest(".recode-form-create-deal")?m(t,".builder",e):m(t,".builder",r)})})()},W=A;})();
