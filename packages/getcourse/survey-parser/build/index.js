(()=>{var m="form.lt-form",f='[name="formParams[offer_id][]"]',S=".recode-form-create-deal",h=".recode-survey-name",l='[name="surveyData"]';var N=new URL(window.location.href),g=e=>{try{return new URL(e),!0}catch{return!1}};var p=e=>!Number.isNaN(Number(e)),E=e=>{let r=[".jpg",".jpeg",".png",".gif",".bmp",".svg"],t=[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".zip"];return!e||typeof e!="string"||g(e)?!1:[...r,...t].some(s=>e.trim().toLowerCase().endsWith(s))},v=e=>e===0?"\u041D\u0435\u0442":e===1?"\u0414\u0430":E(e)?`\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D \u0444\u0430\u0439\u043B: ${window.origin}/fileservice/control/account/storage?FileAccountStatStorageFilter[filename]=&FileAccountStatStorageFilter[stat_type]=0&FileAccountStatStorageFilter[path]=${e}`:e,y=e=>e.querySelector(h)?.textContent?.trim(),F=(e,r)=>e.reduce((s,[a,c],o)=>{let n=r.querySelector(`[for="field-input-${a}"] .label-value`)?.textContent;return s.push(`\u0412\u043E\u043F\u0440\u043E\u0441 ${o+1}: ${n} 
\u041E\u0442\u0432\u0435\u0442: ${v(c)}`),s},[]).join(`

`),P=(e,r)=>{let t=[];return p(e)&&t.push({name:`formParams[userCustomFields][${e}]`,title:"user_survey",fieldSelector:`[name="formParams[userCustomFields][${e}]"]`}),p(r)&&t.push({name:`formParams[dealCustomFields][${r}]`,title:"deal_survey",fieldSelector:`[name="formParams[dealCustomFields][${r}]"]`}),t},w=e=>{try{return Object.entries(JSON.parse(e))}catch(r){return global.console.error("RE-CODE STUDIO. \u041F\u043B\u0430\u0433\u0438\u043D gcSurveyParser. \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0440\u0430\u0437\u0431\u043E\u0440\u0435 \u0434\u0430\u043D\u043D\u044B\u0445 \u0430\u043D\u043A\u0435\u0442\u044B:",r),[]}};var D=(e,r)=>{let t=r.filter(({name:o})=>o.includes("userCustomFields")),s=(o,n)=>{let i=document.createElement("input");return n&&i.setAttribute("data-field-title",n),i.setAttribute("name",o),i.setAttribute("type","hidden"),i},a=(o,n)=>n.filter(({fieldSelector:i})=>!o.querySelector(i)),c=(o,n,i)=>{a(o,i).forEach(({name:u,title:d})=>{o.querySelector(n)?o.querySelector(n).appendChild(s(u,d)):o.appendChild(s(u,d))})};e.querySelector(f)||e.closest(S)?c(e,".builder",r):c(e,".builder",t)},x=D;var U=(e,r)=>{let t=e.querySelector(l)?.value;if(!t)return;let s=w(t),a=y(e),c=F(s,e);a&&(c=`\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0430\u043D\u043A\u0435\u0442\u044B: ${a}

${c}`),r.forEach(({fieldSelector:o})=>{let n=e.querySelector(o);n&&(n.value=c)})},C=U;var $=e=>({userFieldId:e?.userFieldId||void 0,dealFieldId:e?.dealFieldId||void 0}),b=$;window.recode={...window.recode||{},gcSurveyParser:{init(e={}){if(this.config)throw new Error("RE-CODE STUDIO. \u041F\u043B\u0430\u0433\u0438\u043D gcSurveyParser. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u0444\u0443\u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u0430 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430");this.config=b(e);let{userFieldId:r,dealFieldId:t}=this.config;if(!(r||t))throw new Error("RE-CODE STUDIO. \u041F\u043B\u0430\u0433\u0438\u043D gcSurveyParser. \u041D\u0435 \u043F\u0440\u043E\u043F\u0438\u0441\u0430\u043D\u044B \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0434\u043E\u043F. \u043F\u043E\u043B\u0435\u0439 \u0432 \u043A\u043E\u043D\u0444\u0438\u0433\u0435 \u043F\u043B\u0430\u0433\u0438\u043D\u0430");let s=P(r,t);s.length&&document.querySelectorAll(m).forEach(a=>{if(!a.querySelector(l))return;x(a,s),a.querySelector('[type="submit"]')?.addEventListener("click",()=>{C(a,s)})})}}};})();
